
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="lib/signalr-client/signalr-client.js"></script>
<script>
    let transportType = signalR.TransportType[getParameterByName('transport')] || signalR.TransportType.WebSockets;
    let logger = new signalR.ConsoleLogger(signalR.LogLevel.Information);
    let connection = new signalR.HubConnection('/chat', { transport: transportType, logger: logger });

    connection.onclose(e => {
        if (e) {
            appendLine('Connection closed with error: ' + e, 'red');
        }
        else {
            appendLine('Disconnected', 'green');
        }
    });

    connection.on('SetUsersOnline', usersOnline => {
        usersOnline.forEach(user => addUserOnline(user));
    });

    connection.on('UsersJoined', users => {
        users.forEach(user => {
            appendLine('User ' + user.name + ' joined the chat');
            addUserOnline(user);
        });
    });
</script>